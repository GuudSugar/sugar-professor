<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Explore a collection of media related to sugar, including images and videos.">
  <meta name="keywords" content="sugar media, images, videos, infographics">
  <title>Sugar Professor - Media</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
        <h1><a href="index.html">Sugar Professor</a></h1>
        <nav>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="article.html">Articles</a></li>
                <li><a href="media.html">Media</a></li>
            </ul>
        </nav>
    </div>
  </header>

  <!-- Newspaper Section -->
  <section class="section" id="newspaper">
    <div class="container">
      <h2 class="section-header">Newspaper</h2>
      <div class="carousel">
        <ul class="carousel__list" id="newspaper-carousel">
          <!-- Newspaper items will be injected here by JavaScript -->
        </ul>
        <button class="arrow left-arrow" id="newspaper-prev">&lt;</button>
        <button class="arrow right-arrow" id="newspaper-next">&gt;</button>
      </div>
    </div>
  </section>

  <!-- Video Section -->
<section class="section" id="video">
  <div class="container">
    <h2 class="section-header">Video</h2>
    <div class="carousel">
      <ul class="carousel__list" id="video-carousel">
        <!-- Video items will be injected here by JavaScript -->
      </ul>
      <!-- Left Arrow Button -->
      <button class="arrow left-arrow video-arrow" id="video-prev">&lt;</button>
      <!-- Right Arrow Button -->
      <button class="arrow right-arrow video-arrow" id="video-next">&gt;</button>
    </div>
  </div>
</section>

  <!-- Full Screen Overlay -->
  <div class="full-screen-overlay" id="full-screen-overlay">
    <span id="close-overlay">&times;</span>
    <button class="arrow left-arrow" id="full-screen-prev">&lt;</button>
    <button class="arrow right-arrow" id="full-screen-next">&gt;</button>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>&copy; 2024 Sugar Professor. All rights reserved.</p>
      <nav>
        <ul>
          <li><a href="privacy.html">Privacy Policy</a></li>
          <li><a href="terms.html">Terms of Service</a></li>
        </ul>
      </nav>
    </div>
  </footer>

  <script src="scripts.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const loadMedia = (url, containerId) => {
        fetch(url)
          .then(response => response.json())
          .then(data => {
            const mediaContainer = document.getElementById(containerId);
            const carouselList = document.createElement('ul');
            carouselList.classList.add('carousel__list');
            data.forEach((media) => {
              const mediaElement = document.createElement('li');
              mediaElement.className = 'carousel__item';
              if (media.type === 'image') {
                mediaElement.innerHTML = `<img src="${media.url}" alt="${media.title}" style="cursor: pointer;">`;
              } else if (media.type === 'video') {
                mediaElement.innerHTML = `
                  <div class="video-container" style="position: relative;">
                    <video style="cursor: pointer;" muted>
                      <source src="${media.url}" type="video/mp4">Your browser does not support the video tag.
                    </video>
                    <div class="play-button">&#9658;</div>
                  </div>
                `;
              }
              carouselList.appendChild(mediaElement);
            });
            mediaContainer.appendChild(carouselList);
            setupCarouselNavigation(mediaContainer, data.length);
            setupFullScreenView();
          })
          .catch(error => console.error('Error fetching media:', error));
      };
  
      loadMedia('newspaper.json', 'newspaper-carousel');
      loadMedia('video.json', 'video-carousel');
    });
  
    const setupCarouselNavigation = (carouselContainer, totalItems) => {
      const prevButton = carouselContainer.parentElement.querySelector('.left-arrow');
      const nextButton = carouselContainer.parentElement.querySelector('.right-arrow');
      const carouselList = carouselContainer.querySelector('.carousel__list');
      const items = carouselList.querySelectorAll('.carousel__item');
      let currentIndex = 0;
  
      prevButton.addEventListener('click', function() {
        currentIndex = (currentIndex - 1 + totalItems) % totalItems;
        updateCarousel();
      });
  
      nextButton.addEventListener('click', function() {
        currentIndex = (currentIndex + 1) % totalItems;
        updateCarousel();
      });
  
      const updateCarousel = () => {
        const itemWidth = items[0].offsetWidth + 10; // Include margin
        const newPosition = -currentIndex * itemWidth;
        carouselList.style.transform = `translateX(${newPosition}px)`;
      };
    };
  
    const setupFullScreenView = () => {
      const overlay = document.getElementById('full-screen-overlay');
      const closeOverlay = document.getElementById('close-overlay');
      const fullScreenPrev = document.getElementById('full-screen-prev');
      const fullScreenNext = document.getElementById('full-screen-next');
      let mediaItems = [];
      let currentIndex = 0;
  
      const setupImageFullScreen = () => {
        document.querySelectorAll('.carousel__item img').forEach((img, index) => {
          console.log('Adding click listener to image:', img.src, 'Index:', index);
          img.addEventListener('click', function() {
            mediaItems = Array.from(document.querySelectorAll('.carousel__item img'));
            currentIndex = index;
            console.log('Image clicked:', img.src, 'Current Index:', currentIndex);
            showFullScreenMedia(mediaItems[currentIndex].src, 'image');
          });
        });
      };
  
      const setupVideoFullScreen = () => {
        document.querySelectorAll('.carousel__item video').forEach((video, index) => {
          const playButton = video.parentElement.querySelector('.play-button');
          const triggerFullScreen = () => {
            mediaItems = Array.from(document.querySelectorAll('.carousel__item video'));
            currentIndex = index;
            console.log('Video clicked:', video.querySelector('source').src, 'Current Index:', currentIndex);
            showFullScreenMedia(mediaItems[currentIndex].querySelector('source').src, 'video');
          };
          console.log('Adding click listener to video:', video.querySelector('source').src, 'Index:', index);
          playButton.addEventListener('click', triggerFullScreen);
          video.addEventListener('click', triggerFullScreen);
        });
      };
  
      const showFullScreenMedia = (src, type) => {
        console.log('Showing full screen media. Source:', src, 'Type:', type);
        
        // Clear the overlay content first
        overlay.innerHTML = `<span id="close-overlay">&times;</span>`;
        
        // Add the media content based on the type
        if (type === 'image') {
          const imgElement = document.createElement('img');
          imgElement.src = src;
          imgElement.alt = "Full Screen Image";
          overlay.appendChild(imgElement);
        } else if (type === 'video') {
          const videoElement = document.createElement('video');
          videoElement.controls = true;
          videoElement.autoplay = true;
          const sourceElement = document.createElement('source');
          sourceElement.src = src;
          sourceElement.type = "video/mp4";
          videoElement.appendChild(sourceElement);
          overlay.appendChild(videoElement);
        }
        
        overlay.style.display = 'flex';
        setupCloseOverlay();
      };
  
      const setupCloseOverlay = () => {
        document.getElementById('close-overlay').addEventListener('click', function() {
          overlay.style.display = 'none';
          overlay.innerHTML = `<span id="close-overlay">&times;</span>`;
        });
      };
  
      document.addEventListener('keydown', (event) => {
        if (overlay.style.display === 'flex') {
          if (event.key === 'ArrowLeft') {
            navigateFullScreenMedia(-1);
          } else if (event.key === 'ArrowRight') {
            navigateFullScreenMedia(1);
          }
        }
      });
  
      let touchstartX = 0;
      let touchendX = 0;
  
      overlay.addEventListener('touchstart', (event) => {
        touchstartX = event.changedTouches[0].screenX;
      });
  
      overlay.addEventListener('touchend', (event) => {
        touchendX = event.changedTouches[0].screenX;
        handleSwipeGesture();
      });
  
      const handleSwipeGesture = () => {
        console.log('Handling swipe gesture. touchstartX:', touchstartX, 'touchendX:', touchendX);
  
        if (touchendX < touchstartX - 50) {
          navigateFullScreenMedia(1);
        } else if (touchendX > touchstartX + 50) {
          navigateFullScreenMedia(-1);
        }
      };
  
      const navigateFullScreenMedia = (direction) => {
    console.log('Navigating full screen media. Direction:', direction, 'Current Index before update:', currentIndex);

    currentIndex = (currentIndex + direction + mediaItems.length) % mediaItems.length;
    console.log('Current Index after update:', currentIndex);

    const mediaElement = mediaItems[currentIndex];
    if (mediaElement) {
        const mediaType = mediaElement.tagName.toLowerCase();
        const src = mediaType === 'img' ? mediaElement.src : mediaElement.querySelector('source').src;
        console.log('Showing full screen media. Source:', src, 'Type:', mediaType);

        // Clear existing content
        overlay.innerHTML = `<span id="close-overlay">&times;</span>`;

        // Add new media content
        if (mediaType === 'img') {
            const imgElement = document.createElement('img');
            imgElement.src = src;
            imgElement.alt = "Full Screen Image";
            overlay.appendChild(imgElement);
        } else if (mediaType === 'video') {
            const videoElement = document.createElement('video');
            videoElement.controls = true;
            videoElement.autoplay = true;
            const sourceElement = document.createElement('source');
            sourceElement.src = src;
            sourceElement.type = "video/mp4";
            videoElement.appendChild(sourceElement);
            overlay.appendChild(videoElement);
        }
        setupCloseOverlay();
    }
};

  
      setupImageFullScreen();
      setupVideoFullScreen();
    };
  </script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const navToggle = document.querySelector(".nav-toggle");
    const navUl = document.querySelector("header nav ul");

    navToggle.addEventListener("click", function() {
      navUl.classList.toggle("showing");
    });
  });
</script>
  
</body>
</html>
